{% extends "base.html" %} {% block title %}{{ video.title }}{% endblock %} {% block content%}
			<div class="main__content">
				<!-- stream -->
				<section class="movie">
					<!-- bg (can be removed) -->
					<img class="movie__bg" src="https://streami.su/api/images/badge/{{ video.id }}.webp" alt="{{ video.title }}">

					<div class="container">
						<div class="row gx-3">
							<!-- stream content -->
							<div class="col-12 col-xxl-8">
								<div class="movie__content">
									<h1 class="hero__title">{{ video.title }}</h1>
									<p class="hero__text">{{ video.overview }}</p>
									
									<div class="hero__hash" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="You earn FXC per min">
										<img src="img/currencies/flixcoin.svg" alt="">
										<span>+ 0.005</span>
										<span>/ min</span>
									</div>
									<div class="hero__actions">
										<button class="hero__btn" type="button" data-bs-toggle="modal" data-bs-target="#ticket-modal"><span>{{ video.category }}</span></button>
										<button class="hero__favorite" type="button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 7v14l-6 -4l-6 4v-14a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4z"/></svg></button>
									</div>
								</div>
							</div>
							<!-- end stream content -->

							<div class="col-12">
								<div class="row gx-3">
									<!-- player -->
<div id="player-container" class="hero__player" style="margin-top: 20px; height: 100%; width: 100%; position: relative;">
    <!-- Loading overlay -->
    <div id="loading-overlay" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: #000; display: flex; justify-content: center; align-items: center; z-index: 10;">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>
    
    {% for source in stream_src %}
    <div class="stream-source" style="display: none;">
        <p class="source-quality">{{ source.source }} - {% if source.hd %}HD{% else %}SD{% endif %}</p>
        <iframe 
            class="video-iframe" 
            style="border-radius: 20px; height: 100%; width: 100%;" 
            src="{{ source.embedUrl }}" 
            title="{{ video.title }}" 
            allow="accelerometer; encrypted-media; gyroscope; picture-in-picture" 
            allowfullscreen
            onload="document.getElementById('loading-overlay').style.display = 'none'; this.parentElement.style.display = 'block';"
            onerror="handleStreamError(this, '{{ source.source }}')">
        </iframe>
    </div>
    {% endfor %}
</div>

<style>
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    .spinner-border {
        display: inline-block;
        width: 3rem;
        height: 3rem;
        border: 0.25em solid currentColor;
        border-right-color: transparent;
        border-radius: 50%;
        animation: spin 0.75s linear infinite;
    }
</style>

<script>
    // Show first stream by default
    document.addEventListener('DOMContentLoaded', function() {
        const firstStream = document.querySelector('.stream-source');
        if (firstStream) {
            firstStream.style.display = 'block';
        }
    });

    function handleStreamError(iframe, sourceName) {
        console.error(`Error loading stream: ${sourceName}`);
        const container = iframe.closest('.stream-source');
        container.innerHTML = `
            <div class="alert alert-danger">
                Failed to load ${sourceName} stream. Trying next source...
            </div>
        `;
        container.style.display = 'block';
        
        // Try to show next available stream
        const nextContainer = container.nextElementSibling;
        if (nextContainer && nextContainer.classList.contains('stream-source')) {
            nextContainer.style.display = 'block';
        }
    }
</script>

									<!-- chat -->
									<div class="col-12 col-xxl-4">
										<div class="xchat">
											<div class="xchat__content">
												<div class="xchat__messages">
													<div class="xchat__message">
														<p><button type="button">@MovieBuff123:</button> Wow, the special effects in this scene are incredible!</p>
													</div>

													<div class="xchat__message">
														<p><button type="button">@CineFanatic:</button> I didn't see that plot twist coming. Did anyone else?</p>
													</div>

													<div class="xchat__message">
														<p><button type="button">@ReelWatcher:</button> The soundtrack is giving me chills. So well done!</p>
													</div>

													<div class="xchat__message">
														<p><button type="button">@FlickGuru:</button> The protagonist is really growing on me. What a great character arc!</p>
													</div>

													<div class="xchat__message">
														<p><button type="button">@ScreenLover:</button> This movie is so much better than I expected. Loving every minute!</p>
													</div>

													<div class="xchat__message">
														<p><button type="button">@PopcornJunkie:</button> Who's your favorite character so far? Mine has to be the villain!</p>
													</div>

													<div class="xchat__message">
														<p><button type="button">@SilverScreenGeek:</button> Did you guys catch that Easter egg in the background? So cool!</p>
													</div>

													<div class="xchat__message">
														<p><button type="button">@CinemaSage:</button> I'm on the edge of my seat right now. This movie is intense!</p>
													</div>

													<div class="xchat__message">
														<p><button type="button">@MovieManiax:</button> I can't wait to see how this story unfolds. It's so gripping!</p>
													</div>
												</div>
											</div>

											<div class="xchat__cellar">
												<form action="#" class="xchat__form">
													<div class="sign__group">
														<input name="message0" type="text" class="sign__input" placeholder="Message">
													</div>

													<div class="xchat__actions">
														<span class="xchat__online">{{ stream_src.viewers }}</span>

														<button class="xchat__manual" type="button" data-bs-toggle="modal" data-bs-target="#manual-modal"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2"/><path d="M9 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z"/><path d="M9 12h6"/><path d="M9 16h6"/></svg></button>

														<button class="xchat__send" type="button"><span>Send</span></button>
													</div>
												</form>
											</div>
										</div>
									</div>
									<!-- end chat -->
								</div>
							</div>
						</div>
					</div>
				</section>
				<!-- end stream -->

				<!-- online -->
				<section id="section-online" class="section splide splide--online">
					<div class="container">
						<div class="row">
							<!-- section title -->
							<div class="col-12">
								<div class="section__header">
									<h2 class="section__title">Now Watching</h2>

									<div class="section__nav">
										<div class="splide__arrows">
											<button class="splide__arrow splide__arrow--prev" type="button">
												<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 6l-6 6l6 6"/></svg>
											</button>
											<button class="splide__arrow splide__arrow--next" type="button">
												<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 6l6 6l-6 6"/></svg>
											</button>
										</div>
									</div>
								</div>
							</div>
							<!-- end section title -->

							<!-- carousel -->
							<div class="col-12">
								<div class="section__carousel">
									<div class="splide__track">
										<ul class="splide__list">
											<li class="splide__slide">
												<div class="itemcard itemcard--slide">
													<div class="itemcard__cover">
														<img class="itemcard__bg" src="img/covers/cover5-big.jpg" alt="">
														<a href="stream.html" class="item__play">
															<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 4v16l13 -8z"/></svg>
														</a>
														<div class="item__labels">
															<span class="item__online" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Online">
																<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.364 19.364a9 9 0 1 0 -12.728 0"/><path d="M15.536 16.536a5 5 0 1 0 -7.072 0"/><path d="M12 13m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"/></svg>
																<span>2 405</span>
															</span>
														</div>
														<div class="itemcard__hash" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="You earn FXC per min">
															<img src="img/currencies/flixcoin.svg" alt="">
															<span>+ 0.002</span>
														</div>
														<div class="itemcard__title">
															<h3>Fragments of Time</h3>
															<span>Prime Video</span>
														</div>
													</div>
												</div>
											</li>

											<li class="splide__slide">
												<div class="itemcard itemcard--slide">
													<div class="itemcard__cover">
														<img class="itemcard__bg" src="img/covers/cover1-big.jpg" alt="">
														<a href="stream.html" class="item__play">
															<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 4v16l13 -8z"/></svg>
														</a>
														<div class="item__labels">
															<span class="item__online" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Online">
																<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.364 19.364a9 9 0 1 0 -12.728 0"/><path d="M15.536 16.536a5 5 0 1 0 -7.072 0"/><path d="M12 13m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"/></svg>
																<span>1 862</span>
															</span>
														</div>
														<div class="itemcard__hash" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="You earn FXC per min">
															<img src="img/currencies/flixcoin.svg" alt="">
															<span>+ 0.005</span>
														</div>
														<div class="itemcard__title">
															<h3>Beyond the Horizon</h3>
															<span>HBO</span>
														</div>
													</div>
												</div>
											</li>

											<li class="splide__slide">
												<div class="itemcard itemcard--slide">
													<div class="itemcard__cover">
														<img class="itemcard__bg" src="img/covers/cover2-big.jpg" alt="">
														<a href="stream.html" class="item__play">
															<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 4v16l13 -8z"/></svg>
														</a>
														<div class="item__labels">
															<span class="item__online" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Online">
																<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.364 19.364a9 9 0 1 0 -12.728 0"/><path d="M15.536 16.536a5 5 0 1 0 -7.072 0"/><path d="M12 13m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"/></svg>
																<span>1 377</span>
															</span>
														</div>
														<div class="itemcard__hash" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="You earn DOGE per min">
															<img src="img/currencies/doge.svg" alt="">
															<span>+ 0.0002</span>
														</div>
														<div class="itemcard__title">
															<h3>Survival Spliton</h3>
															<span>Netflix</span>
														</div>
													</div>
												</div>
											</li>

											<li class="splide__slide">
												<div class="itemcard itemcard--slide">
													<div class="itemcard__cover">
														<img class="itemcard__bg" src="img/covers/cover4-big.jpg" alt="">
														<a href="stream.html" class="item__play">
															<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 4v16l13 -8z"/></svg>
														</a>
														<div class="item__labels">
															<span class="item__online" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Online">
																<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.364 19.364a9 9 0 1 0 -12.728 0"/><path d="M15.536 16.536a5 5 0 1 0 -7.072 0"/><path d="M12 13m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"/></svg>
																<span>904</span>
															</span>
														</div>
														<div class="itemcard__hash" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="You earn BNB per min">
															<img src="img/currencies/bnb.svg" alt="">
															<span>+ 0.00035</span>
														</div>
														<div class="itemcard__title">
															<h3>Shattered Realities</h3>
															<span>Prime Video</span>
														</div>
													</div>
												</div>
											</li>

											<li class="splide__slide">
												<div class="itemcard itemcard--slide">
													<div class="itemcard__cover">
														<img class="itemcard__bg" src="img/covers/cover3-big.jpg" alt="">
														<a href="stream.html" class="item__play">
															<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 4v16l13 -8z"/></svg>
														</a>
														<div class="item__labels">
															<span class="item__online" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Online">
																<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.364 19.364a9 9 0 1 0 -12.728 0"/><path d="M15.536 16.536a5 5 0 1 0 -7.072 0"/><path d="M12 13m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"/></svg>
																<span>825</span>
															</span>
														</div>
														<div class="itemcard__hash" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="You earn ETH per min">
															<img src="img/currencies/eth.svg" alt="">
															<jspan>+ 0.00022</jspan>
														</div>
														<div class="itemcard__title">
															<h3>The Chebod</h3>
															<span>Miramax</span>
														</div>
													</div>
												</div>
											</li>

											<li class="splide__slide">
												<div class="itemcard itemcard--slide">
													<div class="itemcard__cover">
														<img class="itemcard__bg" src="img/covers/cover6-big.jpg" alt="">
														<a href="stream.html" class="item__play">
															<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 4v16l13 -8z"/></svg>
														</a>
														<div class="item__labels">
															<span class="item__online" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Online">
																<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.364 19.364a9 9 0 1 0 -12.728 0"/><path d="M15.536 16.536a5 5 0 1 0 -7.072 0"/><path d="M12 13m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"/></svg>
																<span>801</span>
															</span>
														</div>
														<div class="itemcard__hash" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="You earn FXC per min">
															<img src="img/currencies/flixcoin.svg" alt="">
															<span>+ 0.0016</span>
														</div>
														<div class="itemcard__title">
															<h3>Celestial Journey</h3>
															<span>Paramount</span>
														</div>
													</div>
												</div>
											</li>
										</ul>
									</div>
								</div>
							</div>
							<!-- end carousel -->
						</div>
					</div>
				</section>
				<!-- end online -->
				{% endblock %}